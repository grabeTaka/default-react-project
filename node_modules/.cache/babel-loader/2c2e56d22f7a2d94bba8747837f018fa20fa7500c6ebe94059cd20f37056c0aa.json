{"ast":null,"code":"var _jsxFileName = \"/home/gab_rub/Projects/tt_shopper/app/frontend/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport Papa from 'papaparse';\nimport ItemTable from './components/ItemTable';\nimport './CSS/App.css';\nimport Header from './components/Header';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [file, setFile] = useState(null);\n  const [error, setError] = useState(null);\n  const [validatedData, setValidatedData] = useState(null);\n  const [readyToUpload, setReadyToUpload] = useState(false);\n  const parseCSV = file => {\n    Papa.parse(file, {\n      header: true,\n      download: true,\n      skipEmptyLines: true,\n      delimiter: ',',\n      complete: handleParseComplete\n    });\n  };\n  useEffect(() => {\n    checkIfReady();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [validatedData]);\n  const handleParseComplete = async results => {\n    const result = await uploadFile(results.data);\n    setValidatedData(result);\n  };\n  const handleFileChange = e => {\n    if (!e.target.files) {\n      return;\n    }\n    setFile(e.target.files[0]);\n  };\n  const handleValidate = async e => {\n    e.preventDefault();\n    if (!file) {\n      return alert('Por favor, selecione um arquivo');\n    }\n    try {\n      parseCSV(file);\n    } catch (error) {\n      setError(error.message);\n    }\n  };\n  const checkIfReady = () => {\n    if (validatedData) {\n      const ready = validatedData.every(item => item.updated);\n      setReadyToUpload(ready);\n    }\n  };\n  const handleReady = async () => {\n    try {\n      await fetch('http://localhost:3001/updateprice', {\n        method: 'POST',\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        credentials: 'include',\n        mode: 'cors',\n        body: JSON.stringify(validatedData)\n      });\n    } catch (error) {\n      setError(error.message);\n    }\n    window.location.reload();\n  };\n  const uploadFile = async parsedValue => {\n    const response = await fetch('http://localhost:3001/validate', {\n      method: 'POST',\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: 'include',\n      mode: 'cors',\n      body: JSON.stringify(parsedValue)\n    });\n    const data = await response.json();\n    return data;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-container\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Atualiza\\xE7\\xE3o de Pre\\xE7os\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Como utilizar:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Carregue um arquivo CSV com o c\\xF3digo do produto a ser reajustado e o novo valor\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Lembre-se que ao ajustar um produto que esteja em um pacote, o pacote tamb\\xE9m ser\\xE1 reajustado\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Clique em \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"VALIDAR\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Se estiver tudo ok, o bot\\xE3o de Atualizar aparecer\\xE1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Confirme suas altera\\xE7\\xF5es e clique em ATUALIZAR para atualizar os pre\\xE7os\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"form\",\n        onSubmit: handleValidate,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          name: \"novo_pre\\xE7o\",\n          accept: \".csv\",\n          onChange: handleFileChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"VALIDAR\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this), validatedData && /*#__PURE__*/_jsxDEV(ItemTable, {\n        products: validatedData\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 27\n      }, this), readyToUpload && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"atualizar-btn\",\n        type: \"button\",\n        onClick: handleReady,\n        children: \"ATUALIZAR\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 19\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 107,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"GeKjd9blSLKlhLu2mzirl8CWCsE=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","Papa","ItemTable","Header","jsxDEV","_jsxDEV","App","_s","file","setFile","error","setError","validatedData","setValidatedData","readyToUpload","setReadyToUpload","parseCSV","parse","header","download","skipEmptyLines","delimiter","complete","handleParseComplete","checkIfReady","results","result","uploadFile","data","handleFileChange","e","target","files","handleValidate","preventDefault","alert","message","ready","every","item","updated","handleReady","fetch","method","headers","credentials","mode","body","JSON","stringify","window","location","reload","parsedValue","response","json","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","name","accept","onChange","products","onClick","_c","$RefreshReg$"],"sources":["/home/gab_rub/Projects/tt_shopper/app/frontend/src/App.tsx"],"sourcesContent":["import React, { FormEvent, useEffect, useState } from 'react';\nimport Papa, { ParseResult } from 'papaparse';\nimport ItemTable from './components/ItemTable';\nimport './CSS/App.css'\nimport Header from './components/Header';\n\ntype Data = {\n  codigo: string;\n  novo_preco: string;\n};\n\ntype UpdatePriceResponseI = {\n  product_code: string;\n  name: string;\n  new_price: string;\n  oldPrice: string;\n  updated: boolean;\n  error: string;\n}\n\n\nfunction App() {\n  const [file, setFile] = useState<File | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [validatedData, setValidatedData] = useState<UpdatePriceResponseI[] | null>(null);\n  const [readyToUpload, setReadyToUpload] = useState<boolean>(false);\n\n  const parseCSV = (file: File) => {\n    Papa.parse(file, {\n      header: true,\n      download: true,\n      skipEmptyLines: true,\n      delimiter: ',',\n      complete: handleParseComplete\n      ,\n    });\n  };\n\n  useEffect(() => {\n    checkIfReady();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [validatedData])\n\n  const handleParseComplete = async (results: ParseResult<Data>) => {\n    const result = await uploadFile(results.data)\n    setValidatedData(result);\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.files) {\n      return;\n    }\n    setFile(e.target.files[0]);\n  }\n\n  const handleValidate = async (e: FormEvent) => {\n    e.preventDefault();\n    if (!file) {\n      return alert('Por favor, selecione um arquivo');\n    }\n    try {\n      parseCSV(file);\n    } catch (error: any) {\n      setError(error.message);\n    }\n  };\n\n  const checkIfReady = () => {\n    if (validatedData) {\n      const ready = validatedData.every((item) => item.updated);\n      setReadyToUpload(ready);\n    }\n  }\n\n  const handleReady = async () => {\n    try {\n      await fetch('http://localhost:3001/updateprice', {\n        method: 'POST',\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: 'include',\n        mode: 'cors',\n        body: JSON.stringify(validatedData),\n      });\n    } catch (error: any) {\n      setError(error.message);\n    }\n    window.location.reload();\n  }\n\n  const uploadFile = async (parsedValue: any) => {\n    const response = await fetch('http://localhost:3001/validate', {\n      method: 'POST',\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      credentials: 'include',\n      mode: 'cors',\n      body: JSON.stringify(parsedValue),\n    });\n    const data = await response.json();\n    return data\n  };\n\n  return (\n    <div className=\"main-container\">\n      <Header />\n      <div className=\"content\">\n        <h1>Atualização de Preços</h1>\n        <p>Como utilizar:</p>\n        <p>\n          Carregue um arquivo CSV com o código do produto a ser reajustado e o\n          novo valor\n        </p>\n        <p>Lembre-se que ao ajustar um produto que esteja em um pacote, o pacote também será reajustado</p>\n        <p>\n          Clique em <strong>VALIDAR</strong>\n        </p>\n        <p>Se estiver tudo ok, o botão de Atualizar aparecerá</p>\n        <p>Confirme suas alterações e clique em ATUALIZAR para atualizar os preços</p>\n        <form className=\"form\" onSubmit={handleValidate}>\n          <input\n            type=\"file\"\n            name=\"novo_preço\"\n            accept=\".csv\"\n            onChange={handleFileChange}\n\n          />\n          <button type=\"submit\">VALIDAR</button>\n        </form>\n        {validatedData && <ItemTable products={validatedData} />}\n        {readyToUpload && (\n          <button className=\"atualizar-btn\" type=\"button\" onClick={handleReady}>\n            ATUALIZAR\n          </button>\n        )}\n        {error && <p>{error}</p>}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}